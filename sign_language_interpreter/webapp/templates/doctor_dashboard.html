{% extends "base.html" %}

{% block title %}Doctor Dashboard - SignHealth{% endblock %}

{% block content %}
<div class="row g-4 mt-2">
    <div class="col-12">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <div>
                <h2 class="mb-1">Doctor Dashboard</h2>
                <p class="text-muted mb-0">Monitor patient communication in real-time</p>
            </div>
            <div class="session-info d-flex align-items-center">
                <span class="status-indicator status-active me-2"></span>
                <div class="text-end">
                    <div class="fw-bold">Session Active</div>
                    <small class="text-muted" id="sessionTime">00:00</small>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row g-4">
    <!-- Translation Feed -->
    <div class="col-lg-8">
        <div class="card h-100">
            <div class="card-header bg-success d-flex justify-content-between align-items-center">
                <h5 class="mb-0">
                    <i class="fas fa-language me-2"></i>Patient Communication
                </h5>
                <div class="d-flex align-items-center">
                    <span class="badge bg-light text-dark me-2">
                        <i class="fas fa-envelope me-1"></i>
                        <span id="messageCount">0</span> messages
                    </span>
                    <button class="btn btn-sm btn-outline-light" id="clearFeedBtn" title="Clear feed">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            </div>
            <div class="card-body d-flex flex-column">
                <div id="translationFeed" class="flex-grow-1 mb-3 p-3">
                    <div class="text-center text-muted">
                        <i class="fas fa-user-injured fa-3x mb-3"></i>
                        <h5>Waiting for patient...</h5>
                        <p class="mb-0">Patient translations will appear here when they start signing</p>
                    </div>
                </div>
                
                <!-- Doctor Response Input -->
                <div class="doctor-input">
                    <div class="input-group">
                        <input type="text" id="doctorMessage" class="form-control" 
                               placeholder="Type your response to patient..." maxlength="200">
                        <button id="sendMessageBtn" class="btn btn-primary">
                            <i class="fas fa-paper-plane me-1"></i>Send
                        </button>
                    </div>
                    <div class="d-flex justify-content-between mt-2">
                        <small class="text-muted">Press Enter to send</small>
                        <small class="text-muted"><span id="charCount">0</span>/200</small>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Sidebar -->
    <div class="col-lg-4">
        <!-- Session Statistics -->
        <div class="card mb-3">
            <div class="card-header bg-info">
                <h5 class="mb-0">
                    <i class="fas fa-chart-line me-2"></i>Session Stats
                </h5>
            </div>
            <div class="card-body">
                <div class="row text-center">
                    <div class="col-6">
                        <div class="stat-item">
                            <div class="stat-number" id="sessionStatus">Active</div>
                            <div class="stat-label">Status</div>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="stat-item">
                            <div class="stat-number" id="messageCountStat">0</div>
                            <div class="stat-label">Messages</div>
                        </div>
                    </div>
                </div>
                
                <hr class="my-3">
                
                <div class="d-flex justify-content-between align-items-center">
                    <span class="text-muted">Session Duration:</span>
                    <span class="fw-bold" id="sessionDuration">00:00</span>
                </div>
            </div>
        </div>
        
        <!-- Quick Actions -->
        <div class="card mb-3">
            <div class="card-header bg-warning">
                <h5 class="mb-0">
                    <i class="fas fa-bolt me-2"></i>Quick Actions
                </h5>
            </div>
            <div class="card-body">
                <div class="d-grid gap-2">
                    <button class="btn btn-outline-primary btn-sm" id="commonPhrase1">
                        <i class="fas fa-comment me-2"></i>"How are you feeling?"
                    </button>
                    <button class="btn btn-outline-primary btn-sm" id="commonPhrase2">
                        <i class="fas fa-comment me-2"></i>"Can you describe the pain?"
                    </button>
                    <button class="btn btn-outline-primary btn-sm" id="commonPhrase3">
                        <i class="fas fa-comment me-2"></i>"Thank you for explaining"
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Consultation Notes -->
        <div class="card">
            <div class="card-header bg-secondary">
                <h5 class="mb-0">
                    <i class="fas fa-notes-medical me-2"></i>Consultation Notes
                </h5>
            </div>
            <div class="card-body">
                <textarea id="consultationNotes" class="form-control mb-3" rows="8" 
                          placeholder="Enter consultation notes and observations..."></textarea>
                <div class="d-grid gap-2">
                    <button id="saveNotesBtn" class="btn btn-success">
                        <i class="fas fa-save me-2"></i>Save Notes
                    </button>
                    <button id="exportNotesBtn" class="btn btn-outline-secondary">
                        <i class="fas fa-download me-2"></i>Export Session
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Audio Player (hidden) -->
<audio id="audioPlayer" style="display: none;"></audio>

<script src="{{ url_for('static', filename='js/doctor.js') }}"></script>

<style>
.stat-item {
    padding: 0.5rem 0;
}

.stat-number {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--primary-color);
}

.stat-label {
    font-size: 0.75rem;
    color: var(--text-secondary);
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.doctor-input {
    border-top: 1px solid var(--border-color);
    padding-top: 1rem;
}

#translationFeed {
    min-height: 400px;
}
</style>
{% endblock %}